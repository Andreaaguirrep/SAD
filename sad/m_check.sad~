ON ECHO;OFF CTIME;

!!MOMENTUM = 1E6;
MOMENTUM = 7007290000;

MARK IP = (BETAX = 10 BETAY = 10);

MULT  QC1RPE655=(L =.01 F1 =.0   FRINGE =0  K0 =.00016   K1 =1e-06
);
 

SOL S1 = (BZ = .2204 BOUND = 1 GEO = 1);
SOL S2 = (BZ = 0);
SOL S3 = (BZ = 0    BOUND = 1);

LINE CELL1 = (IP S1 QC1RPE655 S2 S3);   ! comment
FFS USE CELL1;

INS;
!COD;
NOCOD;
STAT;

CALC;

!!   InitialOrbit->{-5.9611916e-06, 1.83020183e-05, -.00049161637, -.00011390862, 2.246246999e-07,-.000288326126}]},

With[{e = Emittance[Matrix->True, Emittance->False, Orbit->True,
   InitialOrbit->{0, 0, 0, 0, 0, 0}]},
   $tms = TransferMatrices/.e;
   tms[i_Real] := $tms[[i+1]].SymplecticInverse[$tms[[i]]];
   cod = ClosedOrbit/.e;
   ];

 PutCOD[i_Real] := Print[cod[[i]]];
 PutMap[i_Real] := Print[TableForm[tms[i]]];
 PutCOD[4];
 PutMap[3];


!coords={1,{{4.36287e-15},{-1.07587e-12},{1.503280e-14},{-5.37212e-13},{2.754533e-54},{-3.931556e-07},{1}}};
coords={1,{{0},{0},{0},{0},{0},{0},{1}}};
  Print[coords];
  coords=TrackParticles[coords,1];
  Print[coords];

!!DISP G;

ABORT;
