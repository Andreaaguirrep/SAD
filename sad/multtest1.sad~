!
MOMENTUM= 100 GEV;
ON ECHO;OFF EMIT COD CTIME    RAD RFSW;
LINE     
  CELL=(IP2 ED1 QF1 ED2)
  CELL1=(IP2 QF1 )
 ;
 MULT   QF1     =(L = 1 K1 = 1e-20 K0=0.001 SK0=0.001)
 ;
 MARK   IP1     =(BETAX = 1.93      BETAY =1.93    EMIX = 4.0E-5
           EMIY = 4.0E-5  DP = 0.01 SIGZ = 1.5E-3 )
        IP2     =(BETAX = 0.703     BETAY = 0.703  EMIX = 4.0E-5
           EMIY = 4.0E-5  DP = 0.01 SIGZ = 8E-4 )
;
;
SOL ED1=(BZ=1e-10  GEO = 1 BOUND=1)
    ED2=(BZ=1e-10 BOUND=1)
 ;
 CAVI   CA1 = (VOLT=0.01 MV HARM=10)
;
FFS USE=CELL;
  pe="ED2";
  ins rfsw ring nocod;
  qf1 disfrin 1;
  qf1 sk0 0;
  z0={1,Table[{0},{7}]};
  z0[[2,7,1]]=1;

  qf1 1e-10;cal;
  Twiss[{"DX","DPX","DY","DPY","DZ"},pe]
!  DP0=0.001;cal;DP0=0;
!  DP0=0.002;cal;DP0=0;
!  Twiss[{"DX","DPX","DY","DPY","DZ"},pe]
  e1=Emittance[Emittance->False,Orbit->False,OneTurnInformation->True];
  z1=TrackParticles[z0,1];

  qf1 1e-20;cal;
  Twiss[{"DX","DPX","DY","DPY","DZ"},pe]
  e2=Emittance[Emittance->False,Orbit->False,OneTurnInformation->True];
  z2=TrackParticles[z0,1];

  qf1 0;cal;
  Twiss[{"DX","DPX","DY","DPY","DZ"},pe]
  e3=Emittance[Emittance->False,Orbit->False,OneTurnInformation->True];
  z3=TrackParticles[z0,1];

m1=OneTurnTransferMatrix/.e1
m2=OneTurnTransferMatrix/.e2
m3=OneTurnTransferMatrix/.e3
z1
z2
z3

end
