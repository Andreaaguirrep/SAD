!
! SuperKEKB Lattice Renumbering Library
!
! Maintainor: A.Morita(4794)
! Revision:   $Id: Renumber.n,v 1.4 2011/11/28 05:14:58 amorita Exp $
! Style:      Function Library
! Require:    
!
! Public API:
! *Renumber[]	- Renumber arc elements
!		  Return True(success) or False(failed)
! *RenumberCommand[]	- Generate command string for renumbering
!
With[{
  (* Serial number database *)
  db = {
(* LER *)
 ("B2P"->
  {{"QT5TNP",-239.63545434262412,1},{"QT5TNP",-233.0984581876163,2},{"QT5TNP",-208.73829422727005,3},{"QT5TNP",-187.8473925091408,
    4},
   {"QT5TNP",-163.48722854879455,5},{"QT5TNP",-156.95023239378673,6},{"QT5TNP",-132.59006843344048,7},
   {"QT5TNP",-111.69916671531132,8},{"QT5TNP",-87.33900275496518,9},{"QT5TNP",-80.8020065999574,10},
   {"QT5TNP",-56.44184263961125,11},{"QT5TNP",-35.55094092148215,12},{"QT5TNP",-11.013503699746309,13},
   {"QT5TNP",11.013503699746366,14},{"QT5TNP",35.55094092148221,15},{"QT5TNP",56.44184263961131,16},
   {"QT5TNP",80.80200659995745,17},{"QT5TNP",87.33900275496524,18},{"QT5TNP",111.69916671531138,19},
   {"QT5TNP",132.59006843344048,20},{"QT5TNP",156.9502323937864,21},{"QT5TNP",163.48722854879412,22},
   {"QT5TNP",187.84739250913998,23},{"QT5TNP",208.73829422726902,24},{"QT5TNP",233.09845818761488,25},
   {"QT5TNP",239.6354543426226,26},{"QT5NFP",-239.63545434262244,27},{"QT5NFP",-233.0984581876147,28},
   {"QT5NFP",-208.73829422726885,29},{"QT5NFP",-187.8473925091398,30},{"QT5NFP",-163.48722854879395,31},
   {"QT5NFP",-156.95023239378622,32},{"QT5NFP",-132.59006843344036,33},{"QT5NFP",-111.69916671531132,34},
   {"QT5NFP",-87.33900275496512,35},{"QT5NFP",-80.80200659995717,36},{"QT5NFP",-56.44184263961097,37},
   {"QT5NFP",-35.55094092148238,38},{"QT5NFP",-11.013503699746252,39},{"QT5NFP",11.013503699746252,40},
   {"QT5NFP",35.55094092148238,41},{"QT5NFP",56.44184263961097,42},{"QT5NFP",80.80200659995717,43},{"QT5NFP",87.33900275496512,44},
   {"QT5NFP",111.69916671531132,45},{"QT5NFP",132.5900684334399,46},{"QT5NFP",156.9502323937861,47},
   {"QT5NFP",163.48722854879406,48},{"QT5NFP",187.84739250914026,49},{"QT5NFP",208.73829422726885,50},
   {"QT5NFP",233.09845818761505,51},{"QT5NFP",239.635454342623,52},{"QT5NFP",266.32612960563233,53},
   {"QT5FOP",-265.87049468702116,54},{"QT5FOP",-239.17981942401207,55},{"QT5FOP",-232.6428232690041,56},
   {"QT5FOP",-208.2826593086579,57},{"QT5FOP",-187.39175759052932,58},{"QT5FOP",-163.03159363018312,59},
   {"QT5FOP",-156.49459747517517,60},{"QT5FOP",-132.1344335148292,61},{"QT5FOP",-111.24353179670061,62},
   {"QT5FOP",-86.88336783635441,63},{"QT5FOP",-80.34637168134645,64},{"QT5FOP",-55.98620772100048,65},
   {"QT5FOP",-35.095306002871894,66},{"QT5FOP",-10.557868781139177,67},{"QT5FOP",10.557868781139177,68},
   {"QT5FOP",35.095306002871894,69},{"QT5FOP",55.98620772100048,70},{"QT5FOP",80.34637168134645,71},
   {"QT5FOP",86.88336783635441,72},{"QT5FOP",111.24353179670061,73},{"QT5FOP",132.1344335148292,74},
   {"QT5FOP",156.4945974751754,75},{"QT5FOP",163.03159363018335,76},{"QT5FOP",187.3917575905291,77},
   {"QT5FOP",208.2826593086586,78},{"QT5FOP",232.64282326900434,79},{"QT5FOP",239.1798194240116,80},
   {"QT5OTP",-239.17981942401002,81},{"QT5OTP",-232.64282326900275,82},{"QT5OTP",-208.282659308657,83},
   {"QT5OTP",-187.3917575905275,84},{"QT5OTP",-163.03159363018176,85},{"QT5OTP",-156.4945974751745,86},
   {"QT5OTP",-132.13443351482874,87},{"QT5OTP",-111.24353179669924,88},{"QT5OTP",-86.8833678363535,89},
   {"QT5OTP",-80.34637168134623,90},{"QT5OTP",-55.98620772100048,91},{"QT5OTP",-35.095306002870984,92},
   {"QT5OTP",-10.557868781139405,93},{"QT5OTP",10.557868781139405,94},{"QT5OTP",35.095306002870984,95},
   {"QT5OTP",55.98620772100048,96},{"QT5OTP",80.34637168134623,97},{"QT5OTP",86.8833678363535,98},{"QT5OTP",111.24353179669924,99},
   {"QT5OTP",132.13443351482874,100},{"QT5OTP",156.4945974751745,101},{"QT5OTP",163.03159363018176,102},
   {"QT5OTP",187.3917575905275,103},{"QT5OTP",208.282659308657,104},{"QT5OTP",232.64282326900275,105},
   {"QT5OTP",239.17981942401002,106},{"QT5OTP",262.51997830799564,107}}),
 ("QD1P"->
  {{"QT5TNP",-198.2928433682054,1},{"QT5TNP",-122.14461757437584,2},{"QT5TNP",-45.99639178054673,3},{"QT5TNP",45.99639178054673,4},
   {"QT5TNP",122.1446175743759,5},{"QT5TNP",198.29284336820461,6},{"QT5NFP",-198.29284336820422,7},
   {"QT5NFP",-122.14461757437573,8},{"QT5NFP",-45.9963917805469,9},{"QT5NFP",45.996391780546446,10},
   {"QT5NFP",122.14461757437539,11},{"QT5NFP",198.29284336820433,12},{"QT5FOP",-197.83720844959385,13},
   {"QT5FOP",-121.68898265576513,14},{"QT5FOP",-45.540756861936416,15},{"QT5FOP",45.54075686193596,16},
   {"QT5FOP",121.68898265576468,17},{"QT5FOP",197.8372084495943,18},{"QT5OTP",-197.8372084495918,19},
   {"QT5OTP",-121.68898265576354,20},{"QT5OTP",-45.54075686193528,21},{"QT5OTP",45.54075686193619,22},
   {"QT5OTP",121.68898265576445,23},{"QT5OTP",197.8372084495927,24}}),
 ("QD3P"->
  {{"QT5TNP",-214.47544128270533,1},{"QT5TNP",-182.1102454537055,2},{"QT5TNP",-138.32721548887577,3},{"QT5TNP",-105.96201965987603,
    4},
   {"QT5TNP",-62.17898969504654,5},{"QT5TNP",62.178989695046596,6},{"QT5TNP",105.96201965987609,7},{"QT5TNP",138.32721548887577,8},
   {"QT5TNP",182.11024545370475,9},{"QT5TNP",214.47544128270425,10},{"QT5NFP",-214.47544128270408,11},
   {"QT5NFP",-182.11024545370458,12},{"QT5NFP",-138.3272154888756,13},{"QT5NFP",-105.96201965987575,14},
   {"QT5NFP",-62.17898969504654,15},{"QT5NFP",62.17898969504654,16},{"QT5NFP",105.96201965987575,17},
   {"QT5NFP",138.32721548887548,18},{"QT5NFP",182.1102454537047,19},{"QT5NFP",214.47544128270442,20},
   {"QT5FOP",-214.01980636409348,21},{"QT5FOP",-181.65461053509375,22},{"QT5FOP",-137.87158057026477,23},
   {"QT5FOP",-105.50638474126504,24},{"QT5FOP",-61.723354776436054,25},{"QT5FOP",61.723354776436054,26},
   {"QT5FOP",105.50638474126504,27},{"QT5FOP",137.87158057026477,28},{"QT5FOP",181.6546105350942,29},
   {"QT5FOP",214.01980636409348,30},{"QT5OTP",-214.0198063640919,31},{"QT5OTP",-181.65461053509262,32},
   {"QT5OTP",-137.87158057026363,33},{"QT5OTP",-105.50638474126436,34},{"QT5OTP",-61.72335477643537,35},
   {"QT5OTP",61.72335477643537,36},{"QT5OTP",105.50638474126436,37},{"QT5OTP",137.87158057026363,38},
   {"QT5OTP",181.65461053509262,39},{"QT5OTP",214.0198063640919,40}}),
 ("QD5P"->
  {{"QT5TNP",-242.967227131371,1},{"QT5TNP",-229.76668539886938,2},{"QT5TNP",-166.81900133754144,3},{"QT5TNP",-153.61845960503982,
    4},
   {"QT5TNP",-90.67077554371207,5},{"QT5TNP",-77.4702338112105,6},{"QT5TNP",77.47023381121056,7},{"QT5TNP",90.67077554371212,8},
   {"QT5TNP",153.6184596050395,9},{"QT5TNP",166.819001337541,10},{"QT5TNP",229.766685398868,11},{"QT5TNP",242.9672271313695,12},
   {"QT5NFP",-242.96722713136933,13},{"QT5NFP",-229.76668539886782,14},{"QT5NFP",-166.81900133754084,15},
   {"QT5NFP",-153.61845960503933,16},{"QT5NFP",-90.6707755437119,17},{"QT5NFP",-77.47023381121039,18},
   {"QT5NFP",77.47023381121039,19},{"QT5NFP",90.6707755437119,20},{"QT5NFP",153.61845960503933,21},
   {"QT5NFP",166.81900133754084,22},{"QT5NFP",229.76668539886828,23},{"QT5NFP",242.96722713136978,24},
   {"QT5FOP",-242.51159221275884,25},{"QT5FOP",-229.31105048025734,26},{"QT5FOP",-166.3633664189299,27},
   {"QT5FOP",-153.1628246864284,28},{"QT5FOP",-90.21514062510118,29},{"QT5FOP",-77.01459889259968,30},
   {"QT5FOP",77.01459889259968,31},{"QT5FOP",90.21514062510118,32},{"QT5FOP",153.16282468642862,33},
   {"QT5FOP",166.36336641893035,34},{"QT5FOP",229.31105048025734,35},{"QT5FOP",242.51159221275861,36},
   {"QT5OTP",-242.51159221275702,37},{"QT5OTP",-229.31105048025574,38},{"QT5OTP",-166.36336641892876,39},
   {"QT5OTP",-153.16282468642748,40},{"QT5OTP",-90.2151406251005,41},{"QT5OTP",-77.01459889259922,42},
   {"QT5OTP",77.01459889259922,43},{"QT5OTP",90.2151406251005,44},{"QT5OTP",153.16282468642748,45},
   {"QT5OTP",166.36336641892876,46},{"QT5OTP",229.31105048025574,47},{"QT5OTP",242.51159221275702,48}}),
 ("QEAP"->
  {{"QT5TNP",-248.00189704996043,1},{"QT5TNP",-224.73201548027995,2},{"QT5TNP",-171.85367125613087,3},{"QT5TNP",-148.5837896864504,
    4},
   {"QT5TNP",-95.70544546230144,5},{"QT5TNP",-72.43556389262113,6},{"QT5TNP",72.43556389262119,7},{"QT5TNP",95.7054454623015,8},
   {"QT5TNP",148.5837896864502,9},{"QT5TNP",171.85367125613033,10},{"QT5TNP",224.73201548027868,11},
   {"QT5TNP",248.0018970499588,12},{"QT5NFP",-248.00189704995864,13},{"QT5NFP",-224.7320154802785,14},
   {"QT5NFP",-171.85367125613016,15},{"QT5NFP",-148.58378968645002,16},{"QT5NFP",-95.70544546230121,17},
   {"QT5NFP",-72.43556389262108,18},{"QT5NFP",72.43556389262108,19},{"QT5NFP",95.70544546230121,20},
   {"QT5NFP",148.58378968645002,21},{"QT5NFP",171.85367125613016,22},{"QT5NFP",224.73201548027896,23},
   {"QT5NFP",248.0018970499591,24},{"QT5FOP",-247.54626213134816,25},{"QT5FOP",-224.27638056166802,26},
   {"QT5FOP",-171.39803633751922,27},{"QT5FOP",-148.12815476783908,28},{"QT5FOP",-95.2498105436905,29},
   {"QT5FOP",-71.97992897401036,30},{"QT5FOP",71.97992897401059,31},{"QT5FOP",95.2498105436905,32},{"QT5FOP",148.1281547678393,33},
   {"QT5FOP",171.39803633752013,34},{"QT5FOP",224.27638056166757,35},{"QT5FOP",247.54626213134839,36},
   {"QT5OTP",-247.5462621313468,37},{"QT5OTP",-224.27638056166597,38},{"QT5OTP",-171.39803633751853,39},
   {"QT5OTP",-148.1281547678377,40},{"QT5OTP",-95.24981054369027,41},{"QT5OTP",-71.97992897400945,42},
   {"QT5OTP",71.97992897400945,43},{"QT5OTP",95.24981054369027,44},{"QT5OTP",148.1281547678377,45},
   {"QT5OTP",171.39803633751853,46},{"QT5OTP",224.27638056166597,47},{"QT5OTP",247.5462621313468,48}}),
 ("QF2P"->
  {{"QT5TNP",-205.18612289014382,1},{"QT5TNP",-191.399563846267,2},{"QT5TNP",-129.03789709631425,3},{"QT5TNP",-115.25133805243746,
    4},
   {"QT5TNP",-52.88967130248511,5},{"QT5TNP",-39.10311225860829,6},{"QT5TNP",39.10311225860835,7},{"QT5TNP",52.88967130248517,8},
   {"QT5TNP",115.25133805243752,9},{"QT5TNP",129.03789709631434,10},{"QT5TNP",191.39956384626618,11},
   {"QT5TNP",205.18612289014283,12},{"QT5NFP",-205.18612289014266,13},{"QT5NFP",-191.399563846266,14},
   {"QT5NFP",-129.03789709631417,15},{"QT5NFP",-115.25133805243752,16},{"QT5NFP",-52.889671302484885,17},
   {"QT5NFP",-39.10311225860846,18},{"QT5NFP",39.10311225860846,19},{"QT5NFP",52.889671302484885,20},
   {"QT5NFP",115.2513380524374,21},{"QT5NFP",129.03789709631383,22},{"QT5NFP",191.39956384626635,23},
   {"QT5NFP",205.18612289014277,24},{"QT5FOP",-204.73048797153183,25},{"QT5FOP",-190.9439289276554,26},
   {"QT5FOP",-128.58226217770311,27},{"QT5FOP",-114.79570313382669,28},{"QT5FOP",-52.4340363838744,29},
   {"QT5FOP",-38.64747733999798,30},{"QT5FOP",38.64747733999798,31},{"QT5FOP",52.4340363838744,32},
   {"QT5FOP",114.79570313382669,33},{"QT5FOP",128.58226217770311,34},{"QT5FOP",190.9439289276554,35},
   {"QT5FOP",204.73048797153228,36},{"QT5OTP",-204.7304879715307,37},{"QT5OTP",-190.94392892765381,38},
   {"QT5OTP",-128.58226217770243,39},{"QT5OTP",-114.79570313382555,40},{"QT5OTP",-52.43403638387417,41},
   {"QT5OTP",-38.647477339997295,42},{"QT5OTP",38.647477339997295,43},{"QT5OTP",52.43403638387417,44},
   {"QT5OTP",114.79570313382555,45},{"QT5OTP",128.58226217770243,46},{"QT5OTP",190.94392892765381,47},
   {"QT5OTP",204.7304879715307,48}}),
 ("QF4P"->
  {{"QT5TNP",-219.69734556169055,1},{"QT5TNP",-176.88834117472027,2},{"QT5TNP",-143.549119767861,3},{"QT5TNP",-100.74011538089087,
    4},
   {"QT5TNP",-67.4008939740317,5},{"QT5TNP",67.40089397403176,6},{"QT5TNP",100.74011538089093,7},{"QT5TNP",143.54911976786087,8},
   {"QT5TNP",176.88834117471964,9},{"QT5TNP",219.69734556168936,10},{"QT5NFP",-219.6973455616892,11},
   {"QT5NFP",-176.88834117471947,12},{"QT5NFP",-143.5491197678607,13},{"QT5NFP",-100.74011538089076,14},
   {"QT5NFP",-67.40089397403153,15},{"QT5NFP",67.40089397403153,16},{"QT5NFP",100.74011538089076,17},
   {"QT5NFP",143.54911976786047,18},{"QT5NFP",176.8883411747197,19},{"QT5NFP",219.69734556168942,20},
   {"QT5FOP",-219.24171064307848,21},{"QT5FOP",-176.43270625610876,22},{"QT5FOP",-143.09348484924976,23},
   {"QT5FOP",-100.28448046228004,24},{"QT5FOP",-66.94525905542105,25},{"QT5FOP",66.94525905542105,26},
   {"QT5FOP",100.28448046228004,27},{"QT5FOP",143.09348484924976,28},{"QT5FOP",176.43270625610944,29},
   {"QT5FOP",219.24171064307825,30},{"QT5OTP",-219.24171064307666,31},{"QT5OTP",-176.43270625610785,32},
   {"QT5OTP",-143.0934848492484,33},{"QT5OTP",-100.28448046227959,34},{"QT5OTP",-66.94525905542014,35},
   {"QT5OTP",66.94525905542014,36},{"QT5OTP",100.28448046227959,37},{"QT5OTP",143.0934848492484,38},
   {"QT5OTP",176.43270625610785,39},{"QT5OTP",219.24171064307666,40}}),
 ("QF6P"->
  {{"QT5TNP",-236.3669562651202,1},{"QT5TNP",-160.21873047129063,2},{"QT5TNP",-84.07050467746126,3},{"QT5TNP",84.07050467746137,4},
   {"QT5TNP",160.21873047129026,5},{"QT5TNP",236.36695626511874,6},{"QT5NFP",-236.36695626511857,7},
   {"QT5NFP",-160.2187304712901,8},{"QT5NFP",-84.07050467746126,9},{"QT5NFP",84.07050467746103,10},
   {"QT5NFP",160.21873047128997,11},{"QT5NFP",236.36695626511892,12},{"QT5FOP",-235.9113213465082,13},
   {"QT5FOP",-159.76309555267926,14},{"QT5FOP",-83.61486975885055,15},{"QT5FOP",83.61486975885032,16},
   {"QT5FOP",159.76309555267926,17},{"QT5FOP",235.9113213465082,18},{"QT5OTP",-235.91132134650616,19},
   {"QT5OTP",-159.7630955526779,20},{"QT5OTP",-83.61486975884964,21},{"QT5OTP",83.61486975885009,22},
   {"QT5OTP",159.76309555267835,23},{"QT5OTP",235.9113213465066,24}}),

(* HER *)
 ("B2E"->
  {{"QT5TNE",-264.5977327162989,1},{"QT5TNE",-238.58391680366822,2},{"QT5TNE",-230.3361178837218,3},{"QT5TNE",-205.42347070694717,
    4},
   {"QT5TNE",-187.82616398044254,5},{"QT5TNE",-162.9135168036679,6},{"QT5TNE",-154.6657178837215,7},
   {"QT5TNE",-129.75307070694683,8},{"QT5TNE",-112.15576398044226,9},{"QT5TNE",-87.24311680366759,10},
   {"QT5TNE",-78.99531788372121,11},{"QT5TNE",-54.082670706946544,12},{"QT5TNE",-36.48536398044189,13},
   {"QT5TNE",-12.274372228251366,14},{"QT5TNE",12.274372228251309,15},{"QT5TNE",36.48536398044189,16},
   {"QT5TNE",54.082670706946544,17},{"QT5TNE",78.99531788372121,18},{"QT5TNE",87.24311680366759,19},
   {"QT5TNE",112.1557639804422,20},{"QT5TNE",129.75307070694686,21},{"QT5TNE",154.6657178837208,22},
   {"QT5TNE",162.91351680366716,23},{"QT5TNE",187.82616398044098,24},{"QT5TNE",205.42347070694524,25},
   {"QT5TNE",230.33611788371906,26},{"QT5TNE",238.58391680366543,27},{"QT5TNE",263.8507736852776,28},
   {"QT5NFE",-263.85077368527357,29},{"QT5NFE",-238.5839168036614,30},{"QT5NFE",-230.33611788371502,31},
   {"QT5NFE",-205.4234707069412,32},{"QT5NFE",-187.82616398043695,33},{"QT5NFE",-162.91351680366313,34},
   {"QT5NFE",-154.66571788371675,35},{"QT5NFE",-129.75307070694294,36},{"QT5NFE",-112.15576398043868,37},
   {"QT5NFE",-87.24311680366486,38},{"QT5NFE",-78.9953178837186,39},{"QT5NFE",-54.082670706944555,40},
   {"QT5NFE",-36.485363980440525,41},{"QT5NFE",-12.27437222825074,42},{"QT5NFE",12.274372228250968,43},
   {"QT5NFE",36.48536398044075,44},{"QT5NFE",54.08267070694478,45},{"QT5NFE",78.99531788371883,46},{"QT5NFE",87.24311680366509,47},
   {"QT5NFE",112.15576398043913,48},{"QT5NFE",129.75307070694316,49},{"QT5NFE",154.6657178837172,50},
   {"QT5NFE",162.91351680366347,51},{"QT5NFE",187.8261639804375,52},{"QT5NFE",205.42347070694154,53},
   {"QT5NFE",230.3361178837156,54},{"QT5NFE",238.58391680366185,55},{"QT5NFE",263.0287853790883,56},
   {"QT5FOE",-265.3139538624994,57},{"QT5FOE",-239.07290570143527,58},{"QT5FOE",-230.825106781489,59},
   {"QT5FOE",-205.91245960471497,60},{"QT5FOE",-188.31515287821094,61},{"QT5FOE",-163.4025057014369,62},
   {"QT5FOE",-155.15470678149063,63},{"QT5FOE",-130.2420596047166,64},{"QT5FOE",-112.64475287821256,65},
   {"QT5FOE",-87.73210570143851,66},{"QT5FOE",-79.48430678149225,67},{"QT5FOE",-54.57165960471821,68},
   {"QT5FOE",-36.97435287821418,69},{"QT5FOE",-12.614913457550756,70},{"QT5FOE",12.614913457550983,71},
   {"QT5FOE",36.97435287821463,72},{"QT5FOE",54.57165960471866,73},{"QT5FOE",79.48430678149248,74},{"QT5FOE",87.73210570143874,75},
   {"QT5FOE",112.64475287821278,76},{"QT5FOE",130.24205960471681,77},{"QT5FOE",155.15470678149086,78},
   {"QT5FOE",163.40250570143712,79},{"QT5FOE",188.31515287821094,80},{"QT5FOE",205.91245960471633,81},
   {"QT5FOE",230.82510678148992,82},{"QT5FOE",239.07290570143596,83},{"QT5FOE",264.33976258304756,84},
   {"QT5OTE",-264.33976258304847,85},{"QT5OTE",-239.07290570143687,86},{"QT5OTE",-230.82510678149083,87},
   {"QT5OTE",-205.91245960471724,88},{"QT5OTE",-188.31515287821185,89},{"QT5OTE",-163.40250570143826,90},
   {"QT5OTE",-155.15470678149222,91},{"QT5OTE",-130.24205960471863,92},{"QT5OTE",-112.64475287821324,93},
   {"QT5OTE",-87.73210570143965,94},{"QT5OTE",-79.48430678149361,95},{"QT5OTE",-54.571659604720026,96},
   {"QT5OTE",-36.97435287821463,97},{"QT5OTE",-12.61491345755121,98},{"QT5OTE",12.61491345755121,99},
   {"QT5OTE",36.97435287821463,100},{"QT5OTE",54.571659604720026,101},{"QT5OTE",79.48430678149361,102},
   {"QT5OTE",87.73210570143965,103},{"QT5OTE",112.64475287821324,104},{"QT5OTE",130.24205960471863,105},
   {"QT5OTE",155.15470678149268,106},{"QT5OTE",163.4025057014387,107},{"QT5OTE",188.3151528782123,108},
   {"QT5OTE",205.9124596047177,109},{"QT5OTE",230.8251067814913,110},{"QT5OTE",239.07290570143732,111},
   {"QT5OTE",266.10629692203565,112}}),
 ("QD1E"->
  {{"QT5TNE",-196.62481734369487,1},{"QT5TNE",-120.95441734369453,2},{"QT5TNE",-45.28401734369419,3},{"QT5TNE",45.284017343694245,
    4},
   {"QT5TNE",120.95441734369456,5},{"QT5TNE",196.6248173436931,6},{"QT5NFE",-196.62481734368907,7},{"QT5NFE",-120.9544173436908,8},
   {"QT5NFE",-45.28401734369254,9},{"QT5NFE",45.28401734369277,10},{"QT5NFE",120.95441734369115,11},
   {"QT5NFE",196.62481734368953,12},{"QT5FOE",-197.11380624146295,13},{"QT5FOE",-121.44340624146457,14},
   {"QT5FOE",-45.77300624146619,15},{"QT5FOE",45.773006241466646,16},{"QT5FOE",121.4434062414648,17},
   {"QT5FOE",197.1138062414634,18},{"QT5OTE",-197.11380624146477,19},{"QT5OTE",-121.44340624146616,20},
   {"QT5OTE",-45.773006241467556,21},{"QT5OTE",45.7730062414671,22},{"QT5OTE",121.44340624146571,23},
   {"QT5OTE",197.11380624146477,24}}),
 ("QD3E"->
  {{"QT5TNE",-212.11447416513857,1},{"QT5TNE",-181.13516052225117,2},{"QT5TNE",-136.44407416513823,3},{"QT5TNE",-105.46476052225086
    ,4},
   {"QT5TNE",-60.77367416513789,5},{"QT5TNE",60.77367416513795,6},{"QT5TNE",105.46476052225086,7},{"QT5TNE",136.44407416513837,8},
   {"QT5TNE",181.1351605222498,9},{"QT5TNE",212.11447416513653,10},{"QT5NFE",-212.11447416513238,11},
   {"QT5NFE",-181.13516052224566,12},{"QT5NFE",-136.4440741651341,13},{"QT5NFE",-105.46476052224739,14},
   {"QT5NFE",-60.77367416513607,15},{"QT5NFE",60.77367416513607,16},{"QT5NFE",105.46476052224762,17},
   {"QT5NFE",136.44407416513445,18},{"QT5NFE",181.135160522246,19},{"QT5NFE",212.11447416513283,20},
   {"QT5FOE",-212.60346306290648,21},{"QT5FOE",-181.62414942001965,22},{"QT5FOE",-136.9330630629081,23},
   {"QT5FOE",-105.95374942002127,24},{"QT5FOE",-61.26266306290972,25},{"QT5FOE",61.26266306290995,26},
   {"QT5FOE",105.95374942002127,27},{"QT5FOE",136.9330630629081,28},{"QT5FOE",181.62414942001942,29},
   {"QT5FOE",212.6034630629074,30},{"QT5OTE",-212.60346306290876,31},{"QT5OTE",-181.62414942002079,32},
   {"QT5OTE",-136.93306306291015,33},{"QT5OTE",-105.95374942002218,34},{"QT5OTE",-61.26266306291154,35},
   {"QT5OTE",61.26266306291109,36},{"QT5OTE",105.95374942002172,37},{"QT5OTE",136.9330630629097,38},
   {"QT5OTE",181.62414942002079,39},{"QT5OTE",212.60346306290876,40}}),
 ("QD5E"->
  {{"QT5TNE",-242.82181626364144,1},{"QT5TNE",-226.09821842374862,2},{"QT5TNE",-167.15141626364112,3},{"QT5TNE",-150.4278184237483,
    4},
   {"QT5TNE",-91.48101626364075,5},{"QT5TNE",-74.75741842374799,6},{"QT5TNE",74.75741842374805,7},{"QT5TNE",91.48101626364081,8},
   {"QT5TNE",150.42781842374774,9},{"QT5TNE",167.15141626364033,10},{"QT5TNE",226.098218423746,11},{"QT5TNE",242.8218162636386,12},
   {"QT5NFE",-242.82181626363445,13},{"QT5NFE",-226.09821842374186,14},{"QT5NFE",-167.15141626363618,15},
   {"QT5NFE",-150.4278184237436,16},{"QT5NFE",-91.48101626363814,17},{"QT5NFE",-74.75741842374555,18},
   {"QT5NFE",74.75741842374555,19},{"QT5NFE",91.48101626363814,20},{"QT5NFE",150.42781842374393,21},
   {"QT5NFE",167.15141626363652,22},{"QT5NFE",226.0982184237423,23},{"QT5NFE",242.8218162636349,24},
   {"QT5FOE",-243.31080516140855,25},{"QT5FOE",-226.58720732151596,26},{"QT5FOE",-167.64040516141017,27},
   {"QT5FOE",-150.91680732151758,28},{"QT5FOE",-91.97000516141179,29},{"QT5FOE",-75.2464073215192,30},
   {"QT5FOE",75.2464073215192,31},{"QT5FOE",91.97000516141179,32},{"QT5FOE",150.91680732151758,33},{"QT5FOE",167.6404051614104,34},
   {"QT5FOE",226.58720732151642,35},{"QT5FOE",243.310805161409,36},{"QT5OTE",-243.31080516141037,37},
   {"QT5OTE",-226.58720732151778,38},{"QT5OTE",-167.64040516141176,39},{"QT5OTE",-150.91680732151917,40},
   {"QT5OTE",-91.97000516141316,41},{"QT5OTE",-75.24640732152056,42},{"QT5OTE",75.24640732152011,43},
   {"QT5OTE",91.9700051614127,44},{"QT5OTE",150.91680732151917,45},{"QT5OTE",167.64040516141176,46},
   {"QT5OTE",226.58720732151778,47},{"QT5OTE",243.31080516141037,48}}),
 ("QEAE"->
  {{"QT5TNE",-248.57321534295122,1},{"QT5TNE",-220.3468193444388,2},{"QT5TNE",-172.90281534295093,3},{"QT5TNE",-144.67641934443847,
    4},
   {"QT5TNE",-97.23241534295062,5},{"QT5TNE",-69.00601934443813,6},{"QT5TNE",69.00601934443819,7},{"QT5TNE",97.23241534295062,8},
   {"QT5TNE",144.6764193444381,9},{"QT5TNE",172.90281534294996,10},{"QT5TNE",220.34681934443637,11},
   {"QT5TNE",248.57321534294823,12},{"QT5NFE",-248.57321534294408,13},{"QT5NFE",-220.34681934443222,14},
   {"QT5NFE",-172.90281534294581,15},{"QT5NFE",-144.67641934443395,16},{"QT5NFE",-97.23241534294766,17},
   {"QT5NFE",-69.00601934443603,18},{"QT5NFE",69.00601934443603,19},{"QT5NFE",97.23241534294766,20},
   {"QT5NFE",144.6764193444344,21},{"QT5NFE",172.90281534294604,22},{"QT5NFE",220.3468193444328,23},
   {"QT5NFE",248.57321534294442,24},{"QT5FOE",-249.06220424071807,25},{"QT5FOE",-220.83580824220644,26},
   {"QT5FOE",-173.3918042407197,27},{"QT5FOE",-145.16540824220806,28},{"QT5FOE",-97.72140424072131,29},
   {"QT5FOE",-69.49500824220968,30},{"QT5FOE",69.4950082422099,31},{"QT5FOE",97.72140424072131,32},
   {"QT5FOE",145.16540824220806,33},{"QT5FOE",173.39180424071992,34},{"QT5FOE",220.8358082422069,35},
   {"QT5FOE",249.06220424071853,36},{"QT5OTE",-249.0622042407199,37},{"QT5OTE",-220.83580824220826,38},
   {"QT5OTE",-173.39180424072129,39},{"QT5OTE",-145.16540824220965,40},{"QT5OTE",-97.72140424072268,41},
   {"QT5OTE",-69.49500824221104,42},{"QT5OTE",69.49500824221059,43},{"QT5OTE",97.72140424072222,44},
   {"QT5OTE",145.1654082422092,45},{"QT5OTE",173.39180424072129,46},{"QT5OTE",220.83580824220826,47},
   {"QT5OTE",249.0622042407199,48}}),
 ("QF2E"->
  {{"QT5TNE",-201.514571246974,1},{"QT5TNE",-191.73506344041576,2},{"QT5TNE",-125.84417124697364,3},{"QT5TNE",-116.06466344041542,
    4},
   {"QT5TNE",-50.17377124697333,5},{"QT5TNE",-40.394263440415045,6},{"QT5TNE",40.3942634404151,7},{"QT5TNE",50.17377124697339,8},
   {"QT5TNE",116.06466344041542,9},{"QT5TNE",125.8441712469737,10},{"QT5TNE",191.7350634404142,11},
   {"QT5TNE",201.51457124697214,12},{"QT5NFE",-201.514571246968,13},{"QT5NFE",-191.73506344041004,14},
   {"QT5NFE",-125.84417124696972,15},{"QT5NFE",-116.06466344041178,16},{"QT5NFE",-50.17377124697123,17},
   {"QT5NFE",-40.39426344041385,18},{"QT5NFE",40.39426344041408,19},{"QT5NFE",50.173771246971455,20},
   {"QT5NFE",116.06466344041246,21},{"QT5NFE",125.84417124696984,22},{"QT5NFE",191.73506344041084,23},
   {"QT5NFE",201.51457124696822,24},{"QT5FOE",-202.00356014474164,25},{"QT5FOE",-192.22405233818426,26},
   {"QT5FOE",-126.33316014474326,27},{"QT5FOE",-116.55365233818588,28},{"QT5FOE",-50.66276014474488,29},
   {"QT5FOE",-40.8832523381875,30},{"QT5FOE",40.88325233818796,31},{"QT5FOE",50.662760144745334,32},
   {"QT5FOE",116.55365233818611,33},{"QT5FOE",126.33316014474349,34},{"QT5FOE",192.2240523381838,35},
   {"QT5FOE",202.00356014474255,36},{"QT5OTE",-202.00356014474437,37},{"QT5OTE",-192.22405233818563,38},
   {"QT5OTE",-126.33316014474576,39},{"QT5OTE",-116.55365233818702,40},{"QT5OTE",-50.66276014474715,41},
   {"QT5OTE",-40.88325233818841,42},{"QT5OTE",40.8832523381875,43},{"QT5OTE",50.662760144746244,44},
   {"QT5OTE",116.55365233818611,45},{"QT5OTE",126.33316014474485,46},{"QT5OTE",192.22405233818517,47},
   {"QT5OTE",202.00356014474391,48}}),
 ("QF4E"->
  {{"QT5TNE",-215.62625533856618,1},{"QT5TNE",-177.62337934882356,2},{"QT5TNE",-139.95585533856584,3},{"QT5TNE",-101.95297934882319
    ,4},
   {"QT5TNE",-64.28545533856555,5},{"QT5TNE",64.28545533856561,6},{"QT5TNE",101.95297934882319,7},{"QT5TNE",139.95585533856564,8},
   {"QT5TNE",177.62337934882243,9},{"QT5TNE",215.6262553385638,10},{"QT5NFE",-215.62625533855976,11},
   {"QT5NFE",-177.6233793488184,12},{"QT5NFE",-139.9558553385615,13},{"QT5NFE",-101.95297934882001,14},
   {"QT5NFE",-64.28545533856345,15},{"QT5NFE",64.28545533856368,16},{"QT5NFE",101.95297934882024,17},
   {"QT5NFE",139.95585533856206,18},{"QT5NFE",177.62337934881862,19},{"QT5NFE",215.62625533856044,20},
   {"QT5FOE",-216.11524423633387,21},{"QT5FOE",-178.11236824659204,22},{"QT5FOE",-140.44484423633548,23},
   {"QT5FOE",-102.44196824659366,24},{"QT5FOE",-64.7744442363371,25},{"QT5FOE",64.77444423633756,26},
   {"QT5FOE",102.44196824659389,27},{"QT5FOE",140.4448442363357,28},{"QT5FOE",178.11236824659227,29},
   {"QT5FOE",216.11524423633455,30},{"QT5OTE",-216.1152442363359,31},{"QT5OTE",-178.11236824659363,32},
   {"QT5OTE",-140.4448442363373,33},{"QT5OTE",-102.44196824659502,34},{"QT5OTE",-64.7744442363387,35},
   {"QT5OTE",64.77444423633824,36},{"QT5OTE",102.44196824659457,37},{"QT5OTE",140.44484423633685,38},
   {"QT5OTE",178.11236824659363,39},{"QT5OTE",216.1152442363359,40}}),
 ("QF6E"->
  {{"QT5TNE",-234.46001734369503,1},{"QT5TNE",-158.78961734369472,2},{"QT5TNE",-83.11921734369434,3},{"QT5TNE",83.11921734369446,
    4},
   {"QT5TNE",158.78961734369403,5},{"QT5TNE",234.4600173436923,6},{"QT5NFE",-234.46001734368815,7},
   {"QT5NFE",-158.78961734368988,8},{"QT5NFE",-83.11921734369162,9},{"QT5NFE",83.11921734369207,10},
   {"QT5NFE",158.78961734369045,11},{"QT5NFE",234.46001734368883,12},{"QT5FOE",-234.94900624146203,13},
   {"QT5FOE",-159.27860624146365,14},{"QT5FOE",-83.60820624146527,15},{"QT5FOE",83.60820624146572,16},
   {"QT5FOE",159.2786062414641,17},{"QT5FOE",234.94900624146248,18},{"QT5OTE",-234.9490062414643,19},
   {"QT5OTE",-159.2786062414657,20},{"QT5OTE",-83.60820624146709,21},{"QT5OTE",83.60820624146618,22},
   {"QT5OTE",159.27860624146524,23},{"QT5OTE",234.94900624146385,24}}),

    Null[]},

  (* Helper functions *)
  sdiff = With[{center = (LINE["S", #] + 0.5 * LINE["L", #])&},
    With[{ds = center[#1] - center[#2], C = LINE["S", "$$$"]}, Which[
      ds >  0.5 * C,	ds - C,
      ds < -0.5 * C,	ds + C,
      True,		ds]]]&,

  (* Constants *)
  stol  = 500e-3,
  elms := Union[LINE["ELEMENT", "B2{EP}.*|Q{DF}{123456}{EP}.*|QEA{EP}.*"]],
  qt5  := LINE["NAME", "QT5*"]},

  (* Public API *)
  GenerateDB[] := With[{base = #, p = StringLength[#] + 1}, base->Map[With[{
    elm = #, index = Check[ToExpression[#[p + 1, -1]], 1]},
    Append[First[Sort[{#, sdiff[elm, #]}&/@qt5, Abs[#1[[2]]] < Abs[#2[[2]]]&]],
      index]]&, LINE["NAME", base//".*"]]]&/@elms;

  RenumberCommand[] := StandardForm[StringJoin["Apply[RenumberElement, ",
    ToString[With[{pos = LINE["POSITION", #//".*"],
      sdb = #/.Override[db, #->{}]},
      {#, With[{p = #},
	With[{hit = Select[sdb, Abs[sdiff[p, #[[1]]] - #[[2]]] < stol&, 1]},
	  If[Length[hit] > 0, hit[[1,-1]], Null]]]&/@pos}]&/@elms,
      FormatType->InputForm],
    ", {1}]"]];

  Renumber[] := Check[ToExpression[RenumberCommand[]]; True, False];

  ];

! End of File
